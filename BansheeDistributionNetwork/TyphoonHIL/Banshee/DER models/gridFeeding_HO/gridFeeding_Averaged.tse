version = 4.2

//
// Saved by sw version: 2020.2
// Save timestamp: 21-Aug-2020 @ 02:07:07 PM
//

model "gridFeeding_Averaged" {
    configuration {
        hil_device = "HIL603"
        hil_configuration_id = 2
        simulation_method = trapezoidal
        simulation_time_step = 4e-6
        simulation_discret_scaling = 1.0
        dsp_timer_periods = 100e-6, 50e-3
        ss_calc_method = "systematic elimination"
        enb_pole_shift = True
        enb_gds_oversampling = True
        show_modes = False
        device_ao_limit_enable = True
        cpl_stb = False
        enb_dep_sw_detect = False
        code_section = "external memory"
        data_section = "external memory"
        sys_sp_rate_1 = 5e-05
        sys_sp_rate_2 = 0.001
        sys_real_type_precision = "default"
        user_real_type_precision = "double precision"
        sys_cpu_optimization = "high"
        user_cpu_optimization = "high"
        user_cpu_part_option = "default"
        matrix_based_reduction = True
        cpl_dynamics_analysis = False
        cce_use_relative_names = False
        cce_type_mapping_real = "double"
        cce_type_mapping_uint = "unsigned int"
        cce_type_mapping_int = "int"
        cce_directory = ""
        cce_custom_type_int = ""
        cce_custom_type_uint = ""
        cce_custom_type_real = ""
    }

    component Subsystem Root {
        component "core/Signal Controlled Voltage Source" Va_G {
        }
        [
            position = 9368, 8248
            rotation = right
            size = 64, 32
        ]

        component "core/Signal Controlled Voltage Source" Vb_G {
        }
        [
            position = 9264, 8296
            rotation = right
            size = 64, 32
        ]

        component "core/Signal Controlled Voltage Source" Vc_G {
        }
        [
            position = 9160, 8344
            rotation = right
            size = 64, 32
        ]

        component "core/RL Section" RL2 {
            inductance_per_l_mile = "1.6e-3"
            length_mile = "0.01"
            resistance_per_l_mile = "0.57"
        }
        [
            position = 8952, 8160
            size = 256, 56
        ]

        component "core/Constant Impedance Load" "Constant Impedance Load1" {
            SAB = "1000000.0/3"
            SAn = "1000000.0/3"
            SBC = "1000000.0/3"
            SBn = "1000000.0/3"
            SCA = "1000000.0/3"
            SCn = "1000000.0/3"
            VAB = "26000.0"
            VAn = "26000.0/(3**0.5)"
            VBC = "26000.0"
            VBn = "26000.0/(3**0.5)"
            VCA = "26000.0"
            VCn = "26000.0/(3**0.5)"
            Vn_3ph = "26e3"
            enable_neutral = "True"
            pfA = "0.85"
            pfB = "0.85"
            pfC = "0.85"
            pf_3ph = "0.85"
        }
        [
            position = 8720, 8328
            hide_name = True
            size = 104, 152
        ]

        component src_sine "Sinusoidal Source1" {
            execution_rate = "Ts"
            frequency = "60"
        }
        [
            position = 9416, 8328
            hide_name = True
        ]

        component src_sine "Sinusoidal Source2" {
            execution_rate = "Ts"
            frequency = "60"
            phase = "-120"
        }
        [
            position = 9416, 8376
            hide_name = True
        ]

        component src_sine "Sinusoidal Source3" {
            execution_rate = "Ts"
            frequency = "60"
            phase = "120"
        }
        [
            position = 9416, 8424
            hide_name = True
        ]

        component gen_gain Gain3 {
            gain = "480*np.sqrt(2)/np.sqrt(3)"
        }
        [
            position = 9504, 8328
            hide_name = True
        ]

        component gen_gain Gain4 {
            gain = "480*np.sqrt(2)/np.sqrt(3)"
        }
        [
            position = 9504, 8424
            hide_name = True
        ]

        component gen_gain Gain5 {
            gain = "480*np.sqrt(2)/np.sqrt(3)"
        }
        [
            position = 9504, 8376
            hide_name = True
        ]

        component src_ground gnd1 {
        }
        [
            position = 9368, 8536
        ]

        component src_scada_input Pref {
            execution_rate = "Ts_inv"
            max = "70e3"
            min = "-70e3"
            unit = "W"
        }
        [
            position = 8088, 8304
        ]

        component src_scada_input Qref {
            execution_rate = "Ts_inv"
            max = "70e3"
            min = "-70e3"
            unit = "Vars"
        }
        [
            position = 8088, 8368
        ]

        component sys_hil_marker "Device Marker1" {
        }
        [
            position = 8272, 8096
        ]

        component "core/Voltage Measurement" Vc {
            addr = "11"
            execution_rate = "Ts"
        }
        [
            position = 9072, 8344
            rotation = right
            scale = -1, 1
            size = 64, 32
        ]

        component "core/Voltage Measurement" Va {
            addr = "11"
            execution_rate = "Ts"
        }
        [
            position = 9536, 8240
            rotation = right
            scale = -1, 1
            size = 64, 32
        ]

        component "core/Voltage Measurement" Vb {
            addr = "11"
            execution_rate = "Ts"
        }
        [
            position = 9224, 8416
            rotation = right
            scale = -1, 1
            size = 64, 32
        ]

        component Subsystem "Grid feeding inverter (averaged)" {
            layout = dynamic
            component pas_resistor Rt0b1 {
                resistance = "R_s"
            }
            [
                position = 8096, 8256
                rotation = left
                scale = -1, 1
            ]

            component "core/Current Measurement" Ia1 {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 9256, 7904
                size = 64, 32
            ]

            component pas_resistor Rt0c1 {
                resistance = "R_s"
            }
            [
                position = 8176, 8256
                rotation = left
                scale = -1, 1
            ]

            component pas_inductor Lb1 {
                inductance = "L_o"
            }
            [
                position = 8984, 8000
                rotation = down
            ]

            component "core/Current Measurement" Xi_a1 {
                addr = "14"
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7840, 7904
                scale = 1, -1
                size = 64, 32
            ]

            component pas_capacitor Cc1 {
                capacitance = "C_s"
            }
            [
                position = 8176, 8352
                rotation = right
            ]

            component gen_bus_split "Bus Split1" {
                outputs = "3"
            }
            [
                position = 6856, 7760
                hide_name = True
            ]

            component pas_resistor Ra1 {
                resistance = "R_o"
            }
            [
                position = 8888, 7904
            ]

            component pas_resistor Rb1 {
                resistance = "R_o"
            }
            [
                position = 8888, 8000
            ]

            component pas_inductor L0b1 {
                inductance = "L_i"
            }
            [
                position = 7744, 8000
                rotation = down
            ]

            component "core/Signal Controlled Voltage Source" Va_inv {
            }
            [
                position = 7008, 7944
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component gen_product Product1 {
            }
            [
                position = 6792, 7760
                hide_name = True
            ]

            component pas_capacitor Cb1 {
                capacitance = "C_s"
            }
            [
                position = 8096, 8352
                rotation = right
            ]

            component pas_inductor L0c1 {
                inductance = "L_i"
            }
            [
                position = 7744, 8096
                rotation = down
            ]

            component "core/Current Measurement" Xi_c1 {
                addr = "16"
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7952, 8096
                scale = 1, -1
                size = 64, 32
            ]

            component "core/Voltage Measurement" Ec1 {
                addr = "11"
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8544, 8272
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component src_constant Constant1 {
                execution_rate = "Ts"
                value = "900"
            }
            [
                position = 6624, 8232
                hide_name = True
            ]

            component "core/Voltage Measurement" Ea1 {
                addr = "7"
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8400, 8144
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Signal Controlled Voltage Source" Vc_inv {
            }
            [
                position = 7168, 8136
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Current Measurement" Ib1 {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 9256, 8000
                size = 64, 32
            ]

            component pas_resistor Rc1 {
                resistance = "R_o"
            }
            [
                position = 8888, 8096
            ]

            component "core/Current Measurement" Xi_b1 {
                addr = "15"
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 7888, 8000
                scale = 1, -1
                size = 64, 32
            ]

            component pas_resistor R0b1 {
                resistance = "R_i"
            }
            [
                position = 7632, 8000
            ]

            component "core/Voltage Measurement" Eb1 {
                addr = "9"
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 8464, 8208
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component Subsystem Controller {
                layout = dynamic
                component gen_gain Gain11 {
                    gain = "1/I_DQ"
                }
                [
                    position = 7384, 8616
                    hide_name = True
                    scale = -1, -1
                ]

                component gen_probe f1 {
                }
                [
                    position = 7688, 8264
                    rotation = down
                ]

                component gen_product Product10 {
                }
                [
                    position = 7336, 8296
                    scale = -1, 1
                ]

                component Subsystem Current_abc_to_dq4 {
                    layout = dynamic
                    component gen_terminator Termination1 {
                    }
                    [
                        position = 7952, 8064
                    ]

                    component "core/abc to dq" "abc to dq1" {
                    }
                    [
                        position = 7856, 8008
                        size = 48, 80
                    ]

                    port "^Ea2" {
                        label = "^Ea2"
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 7960
                    ]

                    port "^Eb2" {
                        label = "^Eb2"
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8000
                    ]

                    port "^Ed2" {
                        label = "^Ed2"
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 7976
                    ]

                    port "^Eq2" {
                        label = "^Eq2"
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 8016
                    ]

                    port wt2 {
                        label = "wt2"
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8088
                    ]

                    port "^Ec2" {
                        label = "^Ec2"
                        position = right:6
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8040
                    ]

                    connect "^Eb2" "abc to dq1.vb" as Connection2
                    connect wt2 "abc to dq1.wt" as Connection7
                    connect Termination1.in "abc to dq1.zero_axis" as Connection4
                    connect "^Ea2" "abc to dq1.va" as Connection1
                    connect "^Ec2" "abc to dq1.vc" as Connection3
                    connect "abc to dq1.q_axis" "^Eq2" as Connection6
                    connect "abc to dq1.d_axis" "^Ed2" as Connection5
                }
                [
                    position = 7480, 8680
                    size = 80, 168
                ]

                component Subsystem Current_abc_to_dq {
                    layout = dynamic
                    component "core/abc to dq" "abc to dq1" {
                    }
                    [
                        position = 7856, 8008
                        size = 48, 80
                    ]

                    component gen_terminator Termination1 {
                    }
                    [
                        position = 7952, 8064
                    ]

                    port Xi_d2 {
                        label = "Xi_d2"
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 7976
                    ]

                    port wt2 {
                        label = "wt2"
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8088
                    ]

                    port Xi_c2 {
                        label = "Xi_c2"
                        position = right:5
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8040
                    ]

                    port Xi_a2 {
                        label = "Xi_a2"
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 7960
                    ]

                    port Xi_q2 {
                        label = "Xi_q2"
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8008, 8016
                    ]

                    port Xi_b2 {
                        label = "Xi_b2"
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7704, 8000
                    ]

                    connect Termination1.in "abc to dq1.zero_axis" as Connection4
                    connect Xi_a2 "abc to dq1.va" as Connection1
                    connect "abc to dq1.q_axis" Xi_q2 as Connection6
                    connect Xi_b2 "abc to dq1.vb" as Connection2
                    connect "abc to dq1.d_axis" Xi_d2 as Connection5
                    connect Xi_c2 "abc to dq1.vc" as Connection3
                    connect wt2 "abc to dq1.wt" as Connection7
                }
                [
                    position = 7944, 7880
                    size = 80, 168
                ]

                component gen_gain Gain1 {
                    gain = "1/(2*np.pi)"
                }
                [
                    position = 7744, 8264
                    scale = -1, 1
                ]

                component gen_sum Sum1 {
                }
                [
                    position = 7192, 8224
                    scale = -1, 1
                ]

                component gen_gain Gain14 {
                    gain = "S"
                }
                [
                    position = 7128, 8456
                    rotation = right
                    hide_name = True
                    scale = -1, 1
                ]

                component Subsystem "Outer Power Loop + Inner Current Loop" {
                    layout = dynamic
                    component gen_gain Gain6 {
                        gain = "V_DQ"
                    }
                    [
                        position = 8496, 8456
                        hide_name = True
                        scale = -1, -1
                    ]

                    component Subsystem "dq to abc" {
                        layout = dynamic
                        component src_constant o_ref {
                            execution_rate = "Ts"
                            value = "[0]"
                        }
                        [
                            position = 7520, 8200
                        ]

                        component "core/dq to abc" "dq to abc1" {
                            execution_rate = "inherit"
                        }
                        [
                            position = 7744, 8184
                            size = 48, 80
                        ]

                        port q {
                            label = "Uq1"
                            position = right:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7472, 8168
                        ]

                        port d {
                            label = "Ud1"
                            position = right:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7520, 8136
                        ]

                        port b {
                            label = "b"
                            position = left:3
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7896, 8184
                        ]

                        port alpha {
                            label = "alpha1"
                            position = right:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7600, 8232
                        ]

                        port c {
                            label = "c"
                            position = left:4
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7864, 8216
                        ]

                        port a {
                            label = "a"
                            position = left:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7864, 8152
                        ]

                        connect c "dq to abc1.phase_c" as Connection2
                        connect o_ref.out "dq to abc1.zero_input" as Connection5
                        connect "dq to abc1.phase_b" b as Connection4
                        connect d "dq to abc1.d_input" as Connection3
                        connect q "dq to abc1.q_input" as Connection6
                        connect a "dq to abc1.phase_a" as Connection1
                        connect alpha "dq to abc1.wt" as Connection7
                    }
                    [
                        position = 8344, 8456
                        size = 80, 168
                    ]

                    component gen_gain Gain5 {
                        gain = "V_DQ"
                    }
                    [
                        position = 8464, 8392
                        hide_name = True
                        scale = -1, -1
                    ]

                    component Subsystem "inner current control loop" {
                        layout = dynamic
                        component gen_gain Gain7 {
                            gain = "Li"
                        }
                        [
                            position = 8312, 8368
                            scale = -1, 1
                        ]

                        component gen_gain Gain5 {
                            gain = "[0.5]"
                        }
                        [
                            position = 8024, 8432
                            scale = -1, 1
                        ]

                        component gen_pid_controller "PID controller1" {
                            controller_type = "PI"
                            enb_anti_windup_out = "True"
                            enb_output_limit_out = "True"
                            ki = "Ki_I"
                            kp = "Kp_I"
                            lower_sat_lim = "Imin"
                            upper_sat_lim = "Imax"
                        }
                        [
                            position = 8200, 8040
                            scale = -1, 1
                        ]

                        component src_constant one {
                            execution_rate = "Ts"
                            value = "1e-6"
                        }
                        [
                            position = 8216, 8416
                            scale = -1, 1
                        ]

                        component gen_sum Sum8 {
                            signs = "+-"
                        }
                        [
                            position = 8448, 8024
                            scale = -1, 1
                        ]

                        component gen_pid_controller "PID controller2" {
                            controller_type = "PI"
                            enb_anti_windup_out = "True"
                            enb_output_limit_out = "True"
                            ki = "Ki_I"
                            kp = "Kp_I"
                            lower_sat_lim = "Imin"
                            upper_sat_lim = "Imax"
                        }
                        [
                            position = 8208, 8224
                            scale = -1, 1
                        ]

                        component sys_signal_switch "Signal switch1" {
                            threshold = "0.5"
                        }
                        [
                            position = 8128, 8432
                            scale = -1, -1
                        ]

                        component gen_product Product4 {
                            signs = "*/"
                        }
                        [
                            position = 7904, 8280
                            scale = -1, 1
                        ]

                        component gen_sum Sum9 {
                            signs = "+-"
                        }
                        [
                            position = 8496, 8208
                            hide_name = True
                            scale = -1, 1
                        ]

                        component gen_gain Gain6 {
                            gain = "Li"
                        }
                        [
                            position = 8264, 8152
                            scale = -1, 1
                        ]

                        component gen_product Product2 {
                        }
                        [
                            position = 8208, 8336
                            scale = -1, 1
                        ]

                        component gen_sum Sum7 {
                        }
                        [
                            position = 7760, 8232
                            scale = -1, 1
                        ]

                        component src_constant Limit_zero {
                            execution_rate = "Ts"
                            value = "1e-6"
                        }
                        [
                            position = 8336, 8512
                            scale = -1, 1
                        ]

                        component gen_sum Sum3 {
                        }
                        [
                            position = 7760, 8048
                            scale = -1, 1
                        ]

                        component gen_product Product3 {
                            signs = "*/"
                        }
                        [
                            position = 7904, 8112
                            scale = -1, 1
                        ]

                        component gen_comparator Comparator1 {
                        }
                        [
                            position = 8224, 8472
                            scale = -1, 1
                        ]

                        component gen_product Product1 {
                        }
                        [
                            position = 8168, 8144
                            scale = -1, 1
                        ]

                        component gen_sum Sum6 {
                        }
                        [
                            position = 8032, 8272
                            scale = -1, 1
                        ]

                        component gen_sum Sum5 {
                            signs = "+-"
                        }
                        [
                            position = 8024, 8104
                            scale = -1, 1
                        ]

                        component sys_signal_switch "Signal switch2" {
                            criterion = "ctrl > threshold"
                            threshold = "0.5"
                        }
                        [
                            position = 8280, 8040
                            hide_name = True
                            scale = -1, 1
                        ]

                        component src_constant Constant1 {
                            execution_rate = "Ts"
                            signal_type = "int"
                            value = "0"
                        }
                        [
                            position = 8336, 8056
                            hide_name = True
                            scale = -1, 1
                        ]

                        component sys_signal_switch "Signal switch3" {
                            criterion = "ctrl > threshold"
                            threshold = "0.5"
                        }
                        [
                            position = 8328, 8224
                            hide_name = True
                            scale = -1, 1
                        ]

                        component src_constant Constant2 {
                            execution_rate = "Ts"
                            signal_type = "int"
                            value = "0"
                        }
                        [
                            position = 8400, 8240
                            hide_name = True
                            scale = -1, 1
                        ]

                        component sys_signal_switch "Signal switch4" {
                            criterion = "ctrl > threshold"
                            threshold = "0.5"
                        }
                        [
                            position = 7648, 8064
                            hide_name = True
                            scale = -1, 1
                        ]

                        component src_constant Constant3 {
                            execution_rate = "Ts"
                            signal_type = "int"
                            value = "0"
                        }
                        [
                            position = 7704, 8080
                            hide_name = True
                            scale = -1, 1
                        ]

                        component sys_signal_switch "Signal switch5" {
                            criterion = "ctrl > threshold"
                            threshold = "0.5"
                        }
                        [
                            position = 7648, 8248
                            hide_name = True
                            scale = -1, 1
                        ]

                        component src_constant Constant4 {
                            execution_rate = "Ts"
                            signal_type = "int"
                            value = "0"
                        }
                        [
                            position = 7704, 8264
                            hide_name = True
                            scale = -1, 1
                        ]

                        component gen_gain Gain8 {
                            gain = "1/w_0"
                        }
                        [
                            position = 8304, 8312
                            hide_name = True
                            scale = -1, 1
                        ]

                        component gen_gain Gain9 {
                            gain = "1/w_0"
                        }
                        [
                            position = 8272, 8104
                            hide_name = True
                            scale = -1, 1
                        ]

                        component gen_probe Xi_d_ERR {
                        }
                        [
                            position = 8024, 8008
                            rotation = down
                        ]

                        component gen_probe Xi_q_ERR {
                        }
                        [
                            position = 8024, 8192
                            rotation = down
                        ]

                        port Xi_d_ref1 {
                            label = "Xi_d_ref1"
                            position = right:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8560, 8016
                            rotation = down
                        ]

                        port Ud1 {
                            position = left:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7584, 8064
                            rotation = down
                        ]

                        port Xi_q_ref1 {
                            label = "Xi_q_ref1"
                            position = right:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8640, 8176
                            rotation = down
                        ]

                        port Xi_q_meas1 {
                            label = "Xi_q_meas1"
                            position = right:4
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8640, 8216
                            rotation = down
                        ]

                        port Uq1 {
                            position = left:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7584, 8248
                            rotation = down
                        ]

                        port Xi_d_meas1 {
                            label = "Xi_d_meas1"
                            position = right:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8584, 8056
                            rotation = down
                        ]

                        tag From24 {
                            value = "Ed1"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8112, 8056
                            scale = -1, 1
                            size = 60, 20
                        ]

                        tag From26 {
                            value = "Eq1"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8128, 8264
                            scale = -1, 1
                            size = 60, 20
                        ]

                        tag From25 {
                            value = "w1"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8384, 8312
                            scale = -1, 1
                            size = 60, 20
                        ]

                        tag From27 {
                            value = "VDC1"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8384, 8448
                            scale = -1, 1
                            size = 60, 20
                        ]

                        tag From23 {
                            value = "w1"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8352, 8104
                            scale = -1, 1
                            size = 60, 20
                        ]

                        tag Connect2 {
                            value = "Connect"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8336, 7984
                            hide_name = True
                            scale = -1, 1
                        ]

                        tag Connect3 {
                            value = "Connect"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8384, 8168
                            hide_name = True
                            scale = -1, 1
                        ]

                        tag Connect4 {
                            value = "Connect"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 7704, 8008
                            hide_name = True
                            scale = -1, 1
                        ]

                        tag Connect5 {
                            value = "Connect"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 7704, 8192
                            hide_name = True
                            scale = -1, 1
                        ]

                        junction Junction171 sp
                        [
                            position = 7944, 8288
                        ]

                        junction Junction172 sp
                        [
                            position = 8256, 8448
                        ]

                        junction Junction180 sp
                        [
                            position = 8560, 8056
                        ]

                        junction Junction182 sp
                        [
                            position = 8544, 8216
                        ]

                        junction Junction183 sp
                        [
                            position = 8248, 8040
                        ]

                        junction Junction184 sp
                        [
                            position = 8272, 8224
                        ]

                        connect Gain7.out Product2.in1 as Connection293
                        connect Sum5.in1 Product1.out as Connection24
                        connect Limit_zero.out Comparator1.in2 as Connection251
                        connect Product4.in1 Junction171 as Connection252
                        connect Comparator1.out "Signal switch1.in2" as Connection57
                        connect Junction172 Comparator1.in1 as Connection267
                        connect Sum6.in1 Product2.out as Connection26
                        [
                            breakpoints = 8072, 8336; 8128, 8336
                        ]
                        connect "Signal switch1.in" Junction172 as Connection266
                        connect Product3.out Sum3.in1 as Connection17
                        connect Junction171 Product3.in1 as Connection253
                        [
                            breakpoints = 7960, 8288; 7960, 8120
                        ]
                        connect Gain6.out Product1.in1 as Connection289
                        connect Sum5.out Product3.in as Connection25
                        connect From26 Sum6.in as Connection3
                        connect "Signal switch1.out" Gain5.in as Connection250
                        connect Gain5.out Junction171 as Connection254
                        connect Product4.out Sum7.in1 as Connection19
                        connect From27 Junction172 as Connection268
                        connect one.out "Signal switch1.in1" as Connection40
                        connect Sum6.out Product4.in as Connection27
                        connect Sum5.in From24 as Connection23
                        connect Connect2 "Signal switch2.in2" as Connection21
                        connect Constant1.out "Signal switch2.in1" as Connection328
                        connect Xi_d_meas1 Junction180 as Connection348
                        connect Gain7.in Junction180 as Connection350
                        [
                            breakpoints = 8584, 8328; 8560, 8136
                        ]
                        connect Connect3 "Signal switch3.in2" as Connection356
                        connect Constant2.out "Signal switch3.in1" as Connection357
                        connect Sum9.in1 Junction182 as Connection369
                        connect Junction182 Xi_q_meas1 as Connection370
                        [
                            breakpoints = 8552, 8216
                        ]
                        connect Connect4 "Signal switch4.in2" as Connection375
                        connect Constant3.out "Signal switch4.in1" as Connection376
                        connect Ud1 "Signal switch4.out" as Connection377
                        connect "Signal switch4.in" Sum3.out as Connection378
                        connect Connect5 "Signal switch5.in2" as Connection379
                        connect Constant4.out "Signal switch5.in1" as Connection380
                        connect Sum7.out "Signal switch5.in" as Connection381
                        connect Uq1 "Signal switch5.out" as Connection382
                        connect From25 Gain8.in as Connection401
                        connect Gain8.out Product2.in as Connection402
                        connect From23 Gain9.in as Connection403
                        connect Gain9.out Product1.in as Connection404
                        connect Xi_d_ref1 Sum8.in as Connection405
                        [
                            breakpoints = 8512, 8016
                        ]
                        connect "Signal switch2.in" Sum8.out as Connection406
                        [
                            breakpoints = 8408, 8024; 8408, 8024; 8408, 8024
                        ]
                        connect Sum8.in1 Junction180 as Connection408
                        [
                            breakpoints = 8536, 8056
                        ]
                        connect Sum9.in Xi_q_ref1 as Connection407
                        [
                            breakpoints = 8568, 8200; 8568, 8176; 8568, 8176; 8568, 8176
                        ]
                        connect Junction182 Gain6.in as Connection409
                        [
                            breakpoints = 8544, 8216; 8544, 8216
                        ]
                        connect Sum3.in "PID controller1.out" as Connection410
                        [
                            breakpoints = 7944, 8040; 8160, 8040
                        ]
                        connect "PID controller2.out" Sum7.in as Connection411
                        [
                            breakpoints = 8160, 8224; 7968, 8224
                        ]
                        connect Sum9.out "Signal switch3.in" as Connection412
                        [
                            breakpoints = 8440, 8208
                        ]
                        connect "Signal switch2.out" Junction183 as Connection413
                        connect Junction183 "PID controller1.in" as Connection414
                        connect Xi_d_ERR.in Junction183 as Connection415
                        connect "Signal switch3.out" Junction184 as Connection416
                        connect Junction184 "PID controller2.in" as Connection417
                        connect Xi_q_ERR.in Junction184 as Connection418
                    }
                    [
                        position = 8608, 8424
                        size = 96, 184
                    ]

                    component Subsystem "outer power loop" {
                        layout = dynamic
                        component sys_signal_switch "Signal switch1" {
                            threshold = "0.5"
                        }
                        [
                            position = 8256, 8328
                            scale = -1, -1
                        ]

                        component gen_comparator Comparator1 {
                        }
                        [
                            position = 8352, 8368
                            scale = -1, 1
                        ]

                        component gen_sum Sum3 {
                            signs = "+-"
                        }
                        [
                            position = 8232, 8072
                            scale = -1, 1
                        ]

                        component gen_product Product1 {
                            signs = "*/"
                        }
                        [
                            position = 8120, 8080
                            scale = -1, 1
                        ]

                        component gen_product Product2 {
                            signs = "*/"
                        }
                        [
                            position = 8120, 8168
                            scale = -1, 1
                        ]

                        component gen_product Product4 {
                        }
                        [
                            position = 8440, 8080
                            scale = -1, 1
                        ]

                        component gen_sum Sum4 {
                        }
                        [
                            position = 8232, 8160
                            scale = -1, 1
                        ]

                        component gen_product Product5 {
                        }
                        [
                            position = 8440, 8152
                            scale = -1, 1
                        ]

                        component gen_product Product3 {
                        }
                        [
                            position = 8440, 8008
                            scale = -1, 1
                        ]

                        component src_constant Limit_zero {
                            execution_rate = "Ts"
                            value = "1e-6"
                        }
                        [
                            position = 8464, 8408
                            scale = -1, 1
                        ]

                        component gen_product Product6 {
                        }
                        [
                            position = 8440, 8224
                            scale = -1, 1
                        ]

                        component src_constant one {
                            execution_rate = "Ts"
                            value = "1e-6"
                        }
                        [
                            position = 8344, 8312
                            scale = -1, 1
                        ]

                        port Q_ref {
                            position = right:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8648, 8216
                            rotation = down
                        ]

                        port Eq {
                            label = "Eq"
                            position = right:4
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8648, 8000
                            rotation = down
                        ]

                        port Xi_rq {
                            position = left:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7952, 8080
                            rotation = down
                        ]

                        port Et_p2 {
                            label = "Et^2"
                            position = right:5
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8600, 8360
                            rotation = down
                        ]

                        port Ed {
                            label = "Ed"
                            position = right:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8648, 8072
                            rotation = down
                        ]

                        port P_ref {
                            position = right:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8648, 8144
                            rotation = down
                        ]

                        port Xi_rd {
                            position = left:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 7952, 8168
                            rotation = down
                        ]

                        junction Junction142 sp
                        [
                            position = 8528, 8072
                        ]

                        junction Junction143 sp
                        [
                            position = 8544, 8000
                        ]

                        junction Junction144 sp
                        [
                            position = 8408, 8360
                        ]

                        junction Junction138 sp
                        [
                            position = 8160, 8176
                        ]

                        junction Junction139 sp
                        [
                            position = 8568, 8144
                        ]

                        junction Junction141 sp
                        [
                            position = 8560, 8216
                        ]

                        connect Product1.in Sum3.out as Connection23
                        connect Product6.in1 Junction143 as Connection36
                        connect Product2.in1 Junction138 as Connection25
                        connect Product3.out Sum3.in as Connection28
                        connect Junction138 Product1.in1 as Connection9
                        connect Comparator1.in1 Junction144 as Connection1
                        connect Product6.out Sum4.in1 as Connection37
                        connect Product4.in1 Junction141 as Connection29
                        connect Limit_zero.out Comparator1.in2 as Connection19
                        connect Product4.in Junction142 as Connection30
                        connect Comparator1.out "Signal switch1.in2" as Connection2
                        connect Junction141 Q_ref as Connection11
                        connect "Signal switch1.in" Junction144 as Connection38
                        connect Product4.out Sum3.in1 as Connection31
                        connect Junction142 Ed as Connection12
                        connect Eq Junction143 as Connection3
                        connect Junction143 Product3.in as Connection13
                        connect Product5.in Junction139 as Connection32
                        connect Product5.in1 Junction142 as Connection33
                        connect Product5.out Sum4.in as Connection34
                        connect one.out "Signal switch1.in1" as Connection40
                        connect Product6.in Junction141 as Connection35
                        connect Product2.in Sum4.out as Connection26
                        connect Product3.in1 Junction139 as Connection27
                        connect Junction139 P_ref as Connection48
                        [
                            breakpoints = 8568, 8144; 8600, 8144
                        ]
                        connect Product1.out Xi_rq as Connection49
                        connect Xi_rd Product2.out as Connection50
                        connect Junction144 Et_p2 as Connection51
                        [
                            breakpoints = 8408, 8360; 8424, 8360
                        ]
                        connect "Signal switch1.out" Junction138 as Connection52
                        [
                            breakpoints = 8184, 8328; 8160, 8264; 8160, 8176
                        ]
                    }
                    [
                        position = 8864, 8400
                        size = 176, 128
                    ]

                    component Subsystem squared_Vt2 {
                        layout = dynamic
                        component gen_product Product1 {
                        }
                        [
                            position = 8208, 8160
                            scale = -1, 1
                        ]

                        component gen_sum Sum3 {
                        }
                        [
                            position = 8104, 8192
                            scale = -1, 1
                        ]

                        component gen_product Product2 {
                        }
                        [
                            position = 8208, 8232
                            scale = -1, 1
                        ]

                        port Et_p2 {
                            label = "Et^2"
                            position = left:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8032, 8192
                            rotation = down
                        ]

                        port Eq {
                            label = "Eq"
                            position = right:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8328, 8224
                            rotation = down
                        ]

                        port Ed {
                            label = "Ed"
                            position = right:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8328, 8152
                            rotation = down
                        ]

                        junction Junction137 sp
                        [
                            position = 8280, 8224
                        ]

                        junction Junction136 sp
                        [
                            position = 8280, 8152
                        ]

                        connect Junction137 Eq as Connection3
                        connect Product2.in Junction137 as Connection6
                        connect Sum3.in Product1.out as Connection8
                        connect Junction136 Ed as Connection1
                        connect Product1.in1 Junction136 as Connection4
                        connect Sum3.in1 Product2.out as Connection9
                        connect Product2.in1 Junction137 as Connection5
                        connect Sum3.out Et_p2 as Connection7
                        connect Junction136 Product1.in as Connection2
                    }
                    [
                        position = 9016, 8456
                        size = 48, 56
                    ]

                    component gen_gain Gain7 {
                        gain = "1/S"
                    }
                    [
                        position = 9320, 8352
                        hide_name = True
                        scale = -1, -1
                    ]

                    component gen_gain Gain8 {
                        gain = "1/S"
                    }
                    [
                        position = 9208, 8376
                        hide_name = True
                        scale = -1, -1
                    ]

                    component gen_probe "|E|" {
                    }
                    [
                        position = 9224, 8528
                    ]

                    component gen_math_fnc "Mathematical function1" {
                        mathematical_fn = "sqrt"
                    }
                    [
                        position = 9016, 8528
                        hide_name = True
                    ]

                    component gen_gain Gain9 {
                        gain = "V_ABC*np.sqrt(3)"
                    }
                    [
                        position = 9104, 8528
                        hide_name = True
                        scale = 1, -1
                    ]

                    port Uc1 {
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8256, 8520
                        rotation = down
                    ]

                    port E_q {
                        label = "E_q"
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 9136, 8424
                        scale = -1, 1
                    ]

                    port E_d {
                        label = "E_d"
                        position = right:4
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 9176, 8400
                        scale = -1, 1
                    ]

                    port Ua1 {
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8256, 8392
                        rotation = down
                    ]

                    port Ub1 {
                        position = left:2
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8256, 8456
                        rotation = down
                    ]

                    port P_ref {
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 9392, 8352
                        scale = -1, 1
                    ]

                    port Q_ref {
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 9280, 8376
                        scale = -1, 1
                    ]

                    tag From29 {
                        value = "Xi_d1"
                        scope = masked_subsystem
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8720, 8400
                        scale = -1, 1
                    ]

                    tag From30 {
                        value = "Xi_q1"
                        scope = masked_subsystem
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8720, 8496
                        scale = -1, 1
                    ]

                    tag From1 {
                        value = "alpha1"
                        scope = masked_subsystem
                        kind = sp
                        direction = out
                    }
                    [
                        position = 8608, 8560
                        scale = -1, 1
                        size = 63, 25
                    ]

                    junction Junction6 sp
                    [
                        position = 9056, 8400
                    ]

                    junction Junction7 sp
                    [
                        position = 9080, 8424
                    ]

                    junction Junction8 sp
                    [
                        position = 8968, 8456
                    ]

                    connect "dq to abc.alpha" From1 as Connection229
                    [
                        breakpoints = 8400, 8560; 8544, 8560
                    ]
                    connect "dq to abc.q" Gain6.out as Connection339
                    connect From29 "inner current control loop.Xi_d_meas1" as Connection253
                    connect "dq to abc.a" Ua1 as Connection283
                    connect From30 "inner current control loop.Xi_q_meas1" as Connection257
                    connect Gain5.in "inner current control loop.Ud1" as Connection345
                    [
                        breakpoints = 8544, 8352
                    ]
                    connect "dq to abc.d" Gain5.out as Connection337
                    connect "inner current control loop.Uq1" Gain6.in as Connection346
                    [
                        breakpoints = 8544, 8496
                    ]
                    connect "dq to abc.b" Ub1 as Connection282
                    connect "dq to abc.c" Uc1 as Connection284
                    connect "outer power loop.Xi_rd" "inner current control loop.Xi_d_ref1" as Connection347
                    connect "outer power loop.Xi_rq" "inner current control loop.Xi_q_ref1" as Connection348
                    connect Gain8.out "outer power loop.Q_ref" as Connection363
                    connect Gain7.out "outer power loop.P_ref" as Connection384
                    connect E_d Junction6 as Connection390
                    connect Junction6 "outer power loop.Ed" as Connection391
                    connect squared_Vt2.Ed Junction6 as Connection392
                    connect E_q Junction7 as Connection393
                    connect Junction7 "outer power loop.Eq" as Connection394
                    connect squared_Vt2.Eq Junction7 as Connection395
                    connect squared_Vt2.Et_p2 Junction8 as Connection396
                    connect Junction8 "outer power loop.Et_p2" as Connection397
                    connect "Mathematical function1.in" Junction8 as Connection398
                    connect "Mathematical function1.out" Gain9.in as Connection403
                    connect Gain9.out "|E|.in" as Connection404
                    connect Q_ref Gain8.in as Connection405
                    [
                        breakpoints = 9248, 8376; 9248, 8376
                    ]
                    connect P_ref Gain7.in as Connection406
                    [
                        breakpoints = 9360, 8352
                    ]
                }
                [
                    position = 7336, 7952
                    size = 128, 152
                ]

                component gen_product Product111 {
                }
                [
                    position = 7336, 8216
                    scale = -1, 1
                ]

                component gen_gain Gain7 {
                    gain = "1/I_DQ"
                }
                [
                    position = 7840, 7944
                    hide_name = True
                    scale = -1, -1
                ]

                component gen_gain Gain15 {
                    gain = "S"
                }
                [
                    position = 7128, 8176
                    rotation = left
                    hide_name = True
                    scale = -1, 1
                ]

                component gen_probe Q1 {
                }
                [
                    position = 7072, 8488
                    rotation = down
                ]

                component gen_bus_join "Bus Join1" {
                    inputs = "3"
                }
                [
                    position = 7200, 7952
                    scale = -1, 1
                ]

                component gen_gain Gain12 {
                    gain = "1/I_DQ"
                }
                [
                    position = 7384, 8744
                    hide_name = True
                    scale = -1, -1
                ]

                component gen_gain Gain6 {
                    gain = "1/I_DQ"
                }
                [
                    position = 7840, 7816
                    hide_name = True
                    scale = -1, -1
                ]

                component gen_probe P1 {
                }
                [
                    position = 7080, 8136
                    rotation = down
                ]

                component gen_product Product13 {
                }
                [
                    position = 7336, 8464
                    scale = -1, 1
                ]

                component gen_product Product12 {
                }
                [
                    position = 7336, 8376
                    scale = -1, 1
                ]

                component gen_sum Sum2 {
                    signs = "+-"
                }
                [
                    position = 7192, 8368
                    scale = -1, 1
                ]

                component Subsystem PLL {
                    layout = dynamic
                    component tm_delay "Unit Delay2" {
                    }
                    [
                        position = 8368, 8448
                        rotation = right
                        hide_name = True
                    ]

                    component gen_gain Gain6 {
                        gain = "-1/V_DQ"
                    }
                    [
                        position = 8056, 8400
                        hide_name = True
                    ]

                    component Subsystem PLL1 {
                        layout = dynamic
                        component gen_pid_controller "PID controller1" {
                            controller_type = "PI"
                            enb_anti_windup_out = "True"
                            enb_output_limit_out = "True"
                            int_init_value = "w_0"
                            ki = "Ki_PLL"
                            kp = "Kp_PLL"
                            lower_sat_lim = "PLL_min"
                            upper_sat_lim = "PLL_max"
                        }
                        [
                            position = 8200, 8152
                            hide_name = True
                        ]

                        component gen_c_function "C function1" {
                            global_variables = "real var;"
                            in_terminal_dimensions = "inherit"
                            in_terminal_dimensions_str = "in inherit"
                            in_terminal_labels = "[(\'in\', True)]"
                            init_fnc = "/*Begin code section*/
var = 0;
/*End code section*/"
                            no_feed_inputs = "[\'\']"
                            no_feed_outputs = "[\'\']"
                            out_terminal_dimensions = "inherit"
                            out_terminal_dimensions_str = "out inherit"
                            out_terminal_labels = "[(\'out\', True)]"
                            output_fnc = "/*Begin code section*/
out = var;
/*End code section*/"
                            parameters = "real Ts;"
                            update_fnc = "/*Begin code section*/
var += (Ts*in);
/*End code section*/"
                        }
                        [
                            position = 8304, 8152
                            hide_name = True
                            size = 80, 48
                        ]

                        component sys_signal_switch "Signal switch2" {
                            criterion = "ctrl > threshold"
                            threshold = "0.5"
                        }
                        [
                            position = 8128, 8152
                            hide_name = True
                        ]

                        component src_constant Constant1 {
                            execution_rate = "Ts"
                            signal_type = "int"
                            value = "0"
                        }
                        [
                            position = 8056, 8168
                            hide_name = True
                        ]

                        component gen_c_function "confine phase" {
                            global_variables = "real x;real floor_in;"
                            in_terminal_dimensions = "inherit"
                            in_terminal_dimensions_str = "in inherit"
                            in_terminal_labels = "[(\'in\', True)]"
                            init_fnc = "/*Begin code section*/
floor_in = 0;
/*End code section*/"
                            no_feed_inputs = "[\'\']"
                            no_feed_outputs = "[\'\']"
                            out_terminal_dimensions = "inherit"
                            out_terminal_dimensions_str = "out inherit"
                            out_terminal_labels = "[(\'out\', True)]"
                            output_fnc = "/*Begin code section*/
x = in/6.283185307179586;
floor_in = floor(x);
out = in - (6.283185307179586*floor_in);
/*End code section*/"
                        }
                        [
                            position = 8416, 8152
                            size = 56, 48
                        ]

                        port wt {
                            label = "wt"
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8496, 8152
                        ]

                        port w {
                            label = "w"
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8304, 8208
                        ]

                        port d {
                            label = "-d"
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 8056, 8136
                            rotation = down
                            scale = -1, 1
                        ]

                        tag Connect2 {
                            value = "Connect"
                            scope = masked_subsystem
                            kind = sp
                            direction = out
                        }
                        [
                            position = 8056, 8088
                            hide_name = True
                        ]

                        junction Junction1 sp
                        [
                            position = 8240, 8152
                        ]

                        connect w Junction1 as Connection19
                        connect "C function1.in" Junction1 as Connection17
                        connect Junction1 "PID controller1.out" as Connection18
                        connect Connect2 "Signal switch2.in2" as Connection21
                        connect Constant1.out "Signal switch2.in1" as Connection328
                        connect d "Signal switch2.in" as Connection329
                        connect "Signal switch2.out" "PID controller1.in" as Connection330
                        connect "C function1.out" "confine phase.in" as Connection331
                        connect "confine phase.out" wt as Connection332
                    }
                    [
                        position = 8432, 8472
                        scale = 1, -1
                        size = 96, 56
                    ]

                    component gen_probe E_d {
                    }
                    [
                        position = 7984, 8256
                        rotation = down
                    ]

                    component gen_probe E_q {
                    }
                    [
                        position = 7984, 8360
                        rotation = down
                    ]

                    component Subsystem "abc to qd" {
                        layout = dynamic
                        component gen_trigonometric "Trigonometric function3" {
                            trigonometric_fn = "cos"
                        }
                        [
                            position = 8128, 7936
                            hide_name = True
                        ]

                        component gen_product Product1 {
                        }
                        [
                            position = 8224, 7912
                            hide_name = True
                        ]

                        component gen_sum Sum3 {
                            signs = "3"
                        }
                        [
                            position = 8304, 8024
                            hide_name = True
                        ]

                        component gen_product Product2 {
                        }
                        [
                            position = 8216, 8024
                            hide_name = True
                        ]

                        component gen_product Product3 {
                        }
                        [
                            position = 8216, 8136
                            hide_name = True
                        ]

                        component gen_trigonometric "Trigonometric function2" {
                            trigonometric_fn = "cos"
                        }
                        [
                            position = 8128, 8048
                            hide_name = True
                        ]

                        component gen_trigonometric "Trigonometric function4" {
                            trigonometric_fn = "cos"
                        }
                        [
                            position = 8128, 8160
                            hide_name = True
                        ]

                        component gen_sum Sum4 {
                        }
                        [
                            position = 7736, 8160
                            hide_name = True
                        ]

                        component src_constant Constant3 {
                            execution_rate = "Ts"
                            value = "2*np.pi/3"
                        }
                        [
                            position = 7648, 8168
                            hide_name = True
                        ]

                        component gen_sum Sum2 {
                            signs = "+-"
                        }
                        [
                            position = 7736, 8048
                            hide_name = True
                        ]

                        component src_constant Constant2 {
                            execution_rate = "Ts"
                            value = "2*np.pi/3"
                        }
                        [
                            position = 7648, 8056
                            hide_name = True
                        ]

                        component gen_trigonometric "Trigonometric function5" {
                        }
                        [
                            position = 8120, 8256
                            hide_name = True
                        ]

                        component gen_product Product4 {
                        }
                        [
                            position = 8216, 8224
                            hide_name = True
                        ]

                        component gen_sum Sum5 {
                            signs = "3"
                        }
                        [
                            position = 8304, 8336
                            hide_name = True
                        ]

                        component gen_product Product5 {
                        }
                        [
                            position = 8200, 8336
                            hide_name = True
                        ]

                        component gen_product Product6 {
                        }
                        [
                            position = 8200, 8448
                            hide_name = True
                        ]

                        component gen_trigonometric "Trigonometric function6" {
                        }
                        [
                            position = 8120, 8368
                            hide_name = True
                        ]

                        component gen_trigonometric "Trigonometric function7" {
                        }
                        [
                            position = 8120, 8480
                            hide_name = True
                        ]

                        component gen_gain Gain1 {
                            gain = "2/3"
                        }
                        [
                            position = 8376, 8024
                            hide_name = True
                        ]

                        component gen_gain Gain2 {
                            gain = "2/3"
                        }
                        [
                            position = 8376, 8336
                            hide_name = True
                        ]

                        port q {
                            position = right:1
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8448, 8024
                        ]

                        port d {
                            position = right:2
                            kind = sp
                            direction =  in
                            sp_type {
                                default = inherit
                                readonly = True
                            }
                        }
                        [
                            position = 8448, 8336
                        ]

                        port theta {
                            position = left:4
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7512, 7936
                        ]

                        port a {
                            position = left:1
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 7904
                            rotation = down
                            scale = -1, 1
                        ]

                        port b {
                            position = left:2
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 8016
                            rotation = down
                            scale = -1, 1
                        ]

                        port c {
                            position = left:3
                            kind = sp
                            direction =  out
                            sp_type {
                                default = auto
                                readonly = True
                            }
                        }
                        [
                            position = 7648, 8128
                            rotation = down
                            scale = -1, 1
                        ]

                        junction Junction11 sp
                        [
                            position = 7688, 7936
                        ]

                        junction Junction12 sp
                        [
                            position = 7688, 8040
                        ]

                        junction Junction3 sp
                        [
                            position = 8056, 7904
                        ]

                        junction Junction13 sp
                        [
                            position = 8032, 7936
                        ]

                        junction Junction7 sp
                        [
                            position = 7960, 8016
                        ]

                        junction Junction8 sp
                        [
                            position = 7936, 8048
                        ]

                        junction Junction9 sp
                        [
                            position = 7864, 8128
                        ]

                        junction Junction10 sp
                        [
                            position = 7840, 8160
                        ]

                        comment Comment1 START <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd"><html><head><meta name="qrichtext" content="1" /><style type="text/css">p, li { white-space: pre-wrap; }</style></head><body style=" font-family:'Arial'; font-size:12pt; font-weight:400; font-style:normal;"><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">q = (2/3)*( a*cos(wt) + b*cos(wt-(2*pi/3)) + c*cos(wt+(2*pi/3)) );</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">d = (2/3)*( a*sin(wt) + b*sin(wt-(2*pi/3)) + c*sin(wt+(2*pi/3)) );</p><p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;">zero = (1/3)*( a + b + c );</p></body></html> ENDCOMMENT 
                        [
                            position = 8512, 7952
                        ]

                        connect "Trigonometric function3.out" Product1.in1 as Connection1151
                        connect Product1.out Sum3.in as Connection1153
                        connect Product2.out Sum3.in1 as Connection1154
                        connect "Trigonometric function2.out" Product2.in1 as Connection1155
                        connect "Trigonometric function4.out" Product3.in1 as Connection1164
                        connect Constant2.out Sum2.in1 as Connection1148
                        connect Product3.out Sum3.in2 as Connection1171
                        connect "Trigonometric function5.out" Product4.in1 as Connection1173
                        connect Product4.out Sum5.in as Connection1174
                        connect Product5.out Sum5.in1 as Connection1175
                        connect "Trigonometric function6.out" Product5.in1 as Connection1176
                        connect "Trigonometric function7.out" Product6.in1 as Connection1179
                        connect Product6.out Sum5.in2 as Connection1183
                        connect Sum3.out Gain1.in as Connection1186
                        connect Junction11 theta as Connection1232
                        connect Gain1.out q as Connection1187
                        connect Sum5.out Gain2.in as Connection1188
                        connect Sum2.in Junction12 as Connection1234
                        connect Gain2.out d as Connection1189
                        connect Junction12 Junction11 as Connection1235
                        connect Sum4.in Junction12 as Connection1236
                        connect a Junction3 as Connection1190
                        connect Junction3 Product1.in as Connection1191
                        connect "Trigonometric function3.in" Junction13 as Connection1237
                        connect Product4.in Junction3 as Connection1192
                        connect Junction13 Junction11 as Connection1238
                        connect "Trigonometric function5.in" Junction13 as Connection1239
                        connect b Junction7 as Connection1213
                        connect Junction7 Product2.in as Connection1214
                        connect Product5.in Junction7 as Connection1215
                        connect Sum2.out Junction8 as Connection1216
                        connect Junction8 "Trigonometric function2.in" as Connection1217
                        connect "Trigonometric function6.in" Junction8 as Connection1218
                        connect Constant3.out Sum4.in1 as Connection1219
                        connect c Junction9 as Connection1220
                        connect Junction9 Product3.in as Connection1221
                        connect Product6.in Junction9 as Connection1222
                        connect Sum4.out Junction10 as Connection1227
                        connect Junction10 "Trigonometric function4.in" as Connection1228
                        [
                            breakpoints = 7840, 8160
                        ]
                        connect "Trigonometric function7.in" Junction10 as Connection1229
                    }
                    [
                        position = 7872, 8352
                        size = 80, 136
                    ]

                    port Ed {
                        label = "Ed"
                        position = left:1
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8056, 8304
                    ]

                    port wt {
                        label = "wt"
                        position = left:5
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8400, 8392
                    ]

                    port Eq {
                        label = "Eq"
                        position = left:3
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8056, 8440
                        scale = -1, 1
                    ]

                    port Ea {
                        label = "Ea"
                        position = right:1
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7752, 8296
                    ]

                    port Eb {
                        label = "Eb"
                        position = right:2
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7752, 8336
                    ]

                    port Ec {
                        label = "Ec"
                        position = right:3
                        kind = sp
                        direction =  out
                        sp_type {
                            default = auto
                            readonly = True
                        }
                    }
                    [
                        position = 7752, 8376
                    ]

                    port w {
                        label = "w"
                        position = left:4
                        kind = sp
                        direction =  in
                        sp_type {
                            default = inherit
                            readonly = True
                        }
                    }
                    [
                        position = 8336, 8408
                    ]

                    junction Junction2 sp
                    [
                        position = 8368, 8392
                    ]

                    junction Junction4 sp
                    [
                        position = 8016, 8304
                    ]

                    junction Junction5 sp
                    [
                        position = 8088, 8400
                    ]

                    junction Junction6 sp
                    [
                        position = 8088, 8400
                    ]

                    connect PLL1.wt Junction2 as Connection1394
                    connect Junction2 "Unit Delay2.in" as Connection1395
                    connect wt Junction2 as Connection1396
                    connect w PLL1.w as Connection1397
                    connect "abc to qd.d" Gain6.in as Connection1408
                    connect "abc to qd.q" Junction4 as Connection1410
                    connect Junction4 Ed as Connection1411
                    connect E_d.in Junction4 as Connection1412
                    connect Ec "abc to qd.c" as Connection1413
                    connect Eb "abc to qd.b" as Connection1414
                    connect Ea "abc to qd.a" as Connection1415
                    connect "Unit Delay2.out" "abc to qd.theta" as Connection1416
                    [
                        breakpoints = 8368, 8480; 7816, 8480
                    ]
                    connect Gain6.out Junction5 as Connection1418
                    connect Junction5 PLL1.d as Connection1419
                    [
                        breakpoints = 8176, 8400; 8176, 8400
                    ]
                    connect E_q.in Junction6 as Connection1421
                    connect Junction6 Junction5 as Connection1422
                    connect Eq Junction6 as Connection1423
                }
                [
                    position = 7944, 8192
                    size = 96, 192
                ]

                component gen_gain Gain5 {
                    gain = "1/V_DQ"
                }
                [
                    position = 7816, 8120
                    hide_name = True
                    scale = -1, -1
                ]

                component gen_gain Gain8 {
                    gain = "1/V_DQ"
                }
                [
                    position = 7816, 8168
                    hide_name = True
                    scale = -1, -1
                ]

                component gen_terminator Termination1 {
                }
                [
                    position = 7464, 8080
                    scale = -1, 1
                ]

                component gen_terminator Termination2 {
                }
                [
                    position = 7464, 8136
                    scale = -1, 1
                ]

                port U_P {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7552, 7888
                    scale = -1, 1
                ]

                port U_Q {
                    position = top:1
                    kind = sp
                    direction =  out
                    sp_type {
                        default = auto
                        readonly = True
                    }
                }
                [
                    position = 7520, 7928
                    scale = -1, 1
                ]

                tag From38 {
                    value = "Xi_q1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7568, 8472
                    scale = -1, 1
                ]

                tag From10 {
                    value = "Ec1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 8264
                    scale = -1, 1
                    size = 60, 20
                ]

                tag Goto20 {
                    value = "Iq1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7304, 8744
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From36 {
                    value = "Ed1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7568, 8208
                    scale = -1, 1
                ]

                tag From7 {
                    value = "Xi_c1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 7944
                    scale = -1, 1
                    size = 60, 20
                ]

                tag Goto19 {
                    value = "Id1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7304, 8616
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From42 {
                    value = "Eq1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7536, 7976
                    scale = -1, 1
                ]

                tag Goto3 {
                    value = "Eq1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7744, 8168
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From39 {
                    value = "Eq1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7568, 8400
                    scale = -1, 1
                ]

                tag Goto4 {
                    value = "Ed1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7744, 8120
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From8 {
                    value = "Ea1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 8120
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From24 {
                    value = "Ib1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8656
                    scale = -1, 1
                ]

                tag From5 {
                    value = "Xi_a1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 7816
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From37 {
                    value = "Xi_d1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7568, 8256
                    scale = -1, 1
                ]

                tag Goto2 {
                    value = "modulator1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7096, 7952
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From20 {
                    value = "Ed1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7536, 8016
                    scale = -1, 1
                    size = 67, 20
                ]

                tag Goto22 {
                    value = "Xi_d1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7728, 7816
                    scale = -1, 1
                ]

                tag From28 {
                    value = "alpha1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 7904
                    scale = -1, 1
                ]

                tag From6 {
                    value = "Xi_b1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 7856
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From26 {
                    value = "alpha1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8704
                    scale = -1, 1
                ]

                tag From23 {
                    value = "Ia1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8616
                    scale = -1, 1
                ]

                tag Goto17 {
                    value = "w1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7744, 8216
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From9 {
                    value = "Eb1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 8072, 8192
                    scale = -1, 1
                    size = 60, 20
                ]

                tag From25 {
                    value = "Ic1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7592, 8744
                    scale = -1, 1
                ]

                tag Goto23 {
                    value = "Xi_q1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7728, 7944
                    scale = -1, 1
                ]

                tag Goto21 {
                    value = "alpha1"
                    scope = masked_subsystem
                    kind = sp
                    direction = in
                }
                [
                    position = 7832, 8264
                    scale = -1, 1
                ]

                tag From43 {
                    value = "Iq1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7584, 8080
                    scale = -1, 1
                ]

                tag From44 {
                    value = "Id1"
                    scope = masked_subsystem
                    kind = sp
                    direction = out
                }
                [
                    position = 7584, 8136
                    scale = -1, 1
                    size = 67, 20
                ]

                junction Junction229 sp
                [
                    position = 7520, 8256
                ]

                junction Junction230 sp
                [
                    position = 7472, 8472
                ]

                junction Junction228 sp
                [
                    position = 7520, 8400
                ]

                junction Junction159 sp
                [
                    position = 7472, 8208
                ]

                junction Junction231 sp
                [
                    position = 7792, 8216
                ]

                connect Product111.in Junction159 as Connection703
                connect Product10.in Junction229 as Connection723
                connect From25 "Current_abc_to_dq4.^Ec2" as Connection699
                connect Junction230 From38 as Connection677
                connect "Current_abc_to_dq4.^Ea2" From23 as Connection701
                connect Goto20 Gain12.out as Connection878
                connect Product10.in1 Junction228 as Connection681
                connect Current_abc_to_dq.Xi_d2 Gain6.in as Connection864
                connect "Outer Power Loop + Inner Current Loop.Ua1" "Bus Join1.in" as Connection839
                connect Product12.in Junction159 as Connection720
                connect Junction229 From37 as Connection683
                connect Product13.in Junction228 as Connection679
                connect Gain12.in "Current_abc_to_dq4.^Eq2" as Connection879
                connect "Current_abc_to_dq4.^Ed2" Gain11.in as Connection876
                connect Q1.in Gain14.out as Connection959
                connect Product111.in1 Junction229 as Connection682
                connect From6 Current_abc_to_dq.Xi_b2 as Connection39
                connect Junction159 From36 as Connection698
                connect f1.in Gain1.out as Connection318
                connect Current_abc_to_dq4.wt2 From26 as Connection702
                connect "Outer Power Loop + Inner Current Loop.Uc1" "Bus Join1.in2" as Connection840
                connect Junction228 From39 as Connection680
                connect "Current_abc_to_dq4.^Eb2" From24 as Connection700
                connect P1.in Gain15.out as Connection961
                connect Product13.in1 Junction230 as Connection676
                connect Product12.in1 Junction230 as Connection678
                connect Goto2 "Bus Join1.out" as Connection51
                connect Sum1.in1 Product13.out as Connection719
                connect From5 Current_abc_to_dq.Xi_a2 as Connection38
                connect Current_abc_to_dq.wt2 From28 as Connection247
                [
                    breakpoints = 8000, 7904; 8040, 7904
                ]
                connect Current_abc_to_dq.Xi_q2 Gain7.in as Connection866
                connect From7 Current_abc_to_dq.Xi_c2 as Connection40
                connect "Bus Join1.in1" "Outer Power Loop + Inner Current Loop.Ub1" as Connection838
                connect Gain11.out Goto19 as Connection877
                connect U_Q "Outer Power Loop + Inner Current Loop.Q_ref" as Connection1000
                connect U_P "Outer Power Loop + Inner Current Loop.P_ref" as Connection1001
                connect Sum2.out Gain14.in as Connection1021
                [
                    breakpoints = 7152, 8368; 7152, 8368; 7152, 8368; 7136, 8368; 7136, 8368; 7136, 8368
                ]
                connect Product10.out Sum2.in as Connection1030
                [
                    breakpoints = 7280, 8296; 7280, 8360
                ]
                connect Product111.out Sum1.in as Connection1046
                [
                    breakpoints = 7288, 8216
                ]
                connect Product12.out Sum2.in1 as Connection1047
                [
                    breakpoints = 7288, 8376
                ]
                connect Gain6.out Goto22 as Connection1050
                [
                    breakpoints = 7776, 7816
                ]
                connect Gain7.out Goto23 as Connection1051
                [
                    breakpoints = 7776, 7944
                ]
                connect From42 "Outer Power Loop + Inner Current Loop.E_q" as Connection1052
                connect From20 "Outer Power Loop + Inner Current Loop.E_d" as Connection1053
                connect Gain15.in Sum1.out as Connection1054
                connect From8 PLL.Ea as Connection1064
                connect PLL.Eb From9 as Connection1065
                connect PLL.Ec From10 as Connection1066
                connect Gain8.out Goto3 as Connection1067
                connect Goto4 Gain5.out as Connection1068
                connect Gain5.in PLL.Ed as Connection1069
                connect Gain8.in PLL.Eq as Connection1070
                connect Goto21 PLL.wt as Connection1071
                connect Goto17 Junction231 as Connection1073
                connect Junction231 PLL.w as Connection1074
                connect Gain1.in Junction231 as Connection1075
                connect Termination1.in From43 as Connection1076
                connect Termination2.in From44 as Connection1077
            }
            [
                position = 6744, 7552
                size = 272, 144
            ]

            component pas_inductor La1 {
                inductance = "L_o"
            }
            [
                position = 8984, 7904
                rotation = down
            ]

            component pas_resistor Rt0a1 {
                resistance = "R_s"
            }
            [
                position = 8016, 8256
                rotation = left
                scale = -1, 1
            ]

            component pas_resistor R0a1 {
                resistance = "R_i"
            }
            [
                position = 7632, 7904
            ]

            component gen_gain Gain1 {
                gain = "0.5"
            }
            [
                position = 6720, 7792
                hide_name = True
            ]

            component pas_inductor L0a1 {
                inductance = "L_i"
            }
            [
                position = 7744, 7904
                rotation = down
            ]

            component pas_inductor Lc1 {
                inductance = "L_o"
            }
            [
                position = 8984, 8096
                rotation = down
            ]

            component pas_resistor R0c1 {
                resistance = "R_i"
            }
            [
                position = 7632, 8096
            ]

            component "core/Signal Controlled Voltage Source" Vb_inv {
            }
            [
                position = 7088, 8040
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Current Measurement" Ic1 {
                execution_rate = "Ts"
                sig_output = "True"
            }
            [
                position = 9256, 8096
                size = 64, 32
            ]

            component pas_capacitor Ca1 {
                capacitance = "C_s"
            }
            [
                position = 8016, 8352
                rotation = right
            ]

            component src_scada_input "Connect GFL" {
                execution_rate = "Ts"
                format = "uint"
                max = "1"
                min = "0"
                signal_type = "uint"
                unit = ""
            }
            [
                position = 9584, 7648
            ]

            component gen_logic_op "Logical operator3" {
                operator = "NOT"
            }
            [
                position = 9704, 7712
                rotation = right
                hide_name = True
            ]

            component gen_digital_probe "GCB OFF" {
            }
            [
                position = 9744, 7760
            ]

            component gen_digital_probe "GCB ON" {
            }
            [
                position = 9744, 7608
                rotation = down
                scale = -1, 1
            ]

            component "core/Triple Pole Single Throw Contactor" S1 {
                ctrl_src = "Model"
            }
            [
                position = 9984, 8000
                size = 64, 256
            ]

            component "core/Voltage Measurement" Va1 {
                addr = "7"
                execution_rate = "Ts"
            }
            [
                position = 10040, 8312
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vb1 {
                addr = "7"
                execution_rate = "Ts"
            }
            [
                position = 10056, 8360
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            component "core/Voltage Measurement" Vc1 {
                addr = "7"
                execution_rate = "Ts"
            }
            [
                position = 10072, 8416
                rotation = right
                scale = -1, 1
                size = 64, 32
            ]

            port Vc {
                label = "Vc"
                position = top:3
                kind = pe
            }
            [
                position = 10160, 8096
                scale = -1, 1
            ]

            port Va {
                label = "Va"
                position = top:1
                kind = pe
            }
            [
                position = 10160, 7904
                scale = -1, 1
            ]

            port setpoint_P {
                position = left:1
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 6680, 7448
                scale = -1, 1
            ]

            port Vb {
                label = "Vb"
                position = top:2
                kind = pe
            }
            [
                position = 10160, 8000
                scale = -1, 1
            ]

            port setpoint_Q {
                position = left:1
                kind = sp
                direction =  out
                sp_type {
                    default = auto
                    readonly = True
                }
            }
            [
                position = 6800, 7448
            ]

            port ground {
                position = bottom:3
                kind = pe
            }
            [
                position = 10208, 8688
                scale = -1, 1
            ]

            tag Goto18 {
                value = "VDC1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 6736, 8232
                hide_name = True
                size = 60, 20
            ]

            tag Goto44 {
                value = "Xi_b1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 7744, 8208
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto30 {
                value = "Ec1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 8352, 8352
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto38 {
                value = "Xi_c1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 7744, 8256
                scale = -1, 1
                size = 60, 20
            ]

            tag From2 {
                value = "modulator1"
                scope = masked_subsystem
                kind = sp
                direction = out
            }
            [
                position = 6648, 7728
                hide_name = True
                size = 60, 20
            ]

            tag Goto32 {
                value = "Ia1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 9096, 7824
                scale = -1, 1
                size = 60, 20
            ]

            tag From3 {
                value = "VDC1"
                scope = masked_subsystem
                kind = sp
                direction = out
            }
            [
                position = 6648, 7792
                hide_name = True
            ]

            tag Goto31 {
                value = "Ic1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 9096, 8048
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto39 {
                value = "Ib1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 9096, 7936
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto35 {
                value = "Xi_a1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 7744, 8160
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto41 {
                value = "Ea1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 8280, 8144
                scale = -1, 1
                size = 60, 20
            ]

            tag Goto40 {
                value = "Eb1"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 8320, 8256
                scale = -1, 1
                size = 60, 20
            ]

            tag Connect1 {
                value = "Connect"
                scope = masked_subsystem
                kind = sp
                direction = in
            }
            [
                position = 9808, 7648
                hide_name = True
            ]

            tag Connect2 {
                value = "Connect"
                scope = masked_subsystem
                kind = sp
                direction = out
            }
            [
                position = 9880, 7784
                hide_name = True
            ]

            junction Junction160 pe
            [
                position = 8096, 8000
            ]

            junction Junction291 pe
            [
                position = 7088, 8688
            ]

            junction Junction161 pe
            [
                position = 8016, 7904
            ]

            junction Junction290 pe
            [
                position = 7168, 8688
            ]

            junction Junction301 sp
            [
                position = 9704, 7648
            ]

            junction Junction302 sp
            [
                position = 9704, 7648
            ]

            junction Junction303 pe
            [
                position = 8400, 7904
            ]

            junction Junction304 pe
            [
                position = 8464, 8000
            ]

            junction Junction305 pe
            [
                position = 8176, 8096
            ]

            junction Junction306 pe
            [
                position = 8544, 8096
            ]

            junction Junction309 pe
            [
                position = 8016, 8688
            ]

            junction Junction310 pe
            [
                position = 8096, 8688
            ]

            junction Junction311 pe
            [
                position = 8176, 8688
            ]

            junction Junction315 pe
            [
                position = 8464, 8688
            ]

            junction Junction316 pe
            [
                position = 8400, 8688
            ]

            junction Junction317 pe
            [
                position = 8544, 8688
            ]

            junction Junction318 pe
            [
                position = 10040, 7904
            ]

            junction Junction319 pe
            [
                position = 10040, 8688
            ]

            junction Junction320 pe
            [
                position = 10056, 8000
            ]

            junction Junction321 pe
            [
                position = 10056, 8688
            ]

            junction Junction322 pe
            [
                position = 10072, 8096
            ]

            junction Junction323 pe
            [
                position = 10072, 8688
            ]

            connect Vc_inv.n_node Junction290 as Connection1060
            connect Rc1.n_node Lc1.n_node as Connection399
            connect Va_inv.n_node Junction291 as Connection1065
            [
                breakpoints = 7008, 8688; 7088, 8688
            ]
            connect Rt0b1.n_node Junction160 as Connection351
            connect Ia1.out Goto32 as Connection666
            connect Xi_a1.n_node Junction161 as Connection314
            connect Product1.in1 Gain1.out as Connection1073
            connect Rb1.n_node Lb1.n_node as Connection354
            connect La1.n_node Ra1.n_node as Connection401
            connect Xi_b1.n_node Junction160 as Connection388
            connect Goto39 Ib1.out as Connection669
            connect From2 Product1.in as Connection1074
            connect Junction291 Junction290 as Connection1064
            [
                breakpoints = 7088, 8688; 7168, 8688
            ]
            connect setpoint_P Controller.U_P as Connection1290
            connect Vb_inv.n_node Junction291 as Connection1063
            connect L0a1.n_node R0a1.n_node as Connection355
            connect Product1.out "Bus Split1.in" as Connection1075
            connect La1.p_node Ia1.p_node as Connection665
            connect Xi_b1.out Goto44 as Connection374
            connect Ic1.out Goto31 as Connection668
            connect Goto35 Xi_a1.out as Connection342
            [
                breakpoints = 7840, 8160; 7840, 8024
            ]
            connect Lc1.p_node Ic1.p_node as Connection663
            connect L0b1.p_node Xi_b1.p_node as Connection372
            connect From3 Gain1.in as Connection1072
            connect Rt0a1.n_node Junction161 as Connection366
            connect L0a1.p_node Xi_a1.p_node as Connection378
            connect Lb1.p_node Ib1.p_node as Connection664
            connect Constant1.out Goto18 as Connection1096
            connect Xi_c1.out Goto38 as Connection313
            connect R0b1.n_node L0b1.n_node as Connection385
            connect L0c1.p_node Xi_c1.p_node as Connection328
            connect R0c1.n_node L0c1.n_node as Connection330
            connect setpoint_Q Controller.U_Q as Connection1308
            connect "GCB OFF.in" "Logical operator3.out" as Connection155
            connect "Connect GFL.out" Junction301 as Connection1332
            connect Junction301 Connect1 as Connection1333
            connect "GCB ON.in" Junction302 as Connection1335
            connect Junction302 Junction301 as Connection1336
            connect "Logical operator3.in" Junction302 as Connection1337
            connect Ea1.p_node Junction303 as Connection1343
            connect Junction303 Junction161 as Connection1344
            [
                breakpoints = 8400, 7904; 8400, 7904; 8400, 7904
            ]
            connect Ra1.p_node Junction303 as Connection1345
            connect Junction160 Junction304 as Connection1346
            [
                breakpoints = 8096, 8000
            ]
            connect Junction304 Eb1.p_node as Connection1347
            [
                breakpoints = 8464, 8000
            ]
            connect Rb1.p_node Junction304 as Connection1348
            connect Xi_c1.n_node Junction305 as Connection1350
            connect Junction305 Rt0c1.n_node as Connection1351
            [
                breakpoints = 8176, 8096
            ]
            connect Rc1.p_node Junction306 as Connection1353
            connect Junction306 Junction305 as Connection1354
            connect Ec1.p_node Junction306 as Connection1355
            connect Ca1.n_node Junction309 as Connection1385
            connect Junction310 Junction309 as Connection1387
            connect Cb1.n_node Junction310 as Connection1388
            connect Junction311 Junction310 as Connection1390
            connect Cc1.n_node Junction311 as Connection1391
            connect Eb1.n_node Junction315 as Connection1403
            connect Junction315 Junction316 as Connection1404
            connect Junction316 Junction311 as Connection1405
            connect Ea1.n_node Junction316 as Connection1406
            connect Va_inv.p_node R0a1.p_node as Connection1417
            connect R0b1.p_node Vb_inv.p_node as Connection1418
            connect Vc_inv.p_node R0c1.p_node as Connection1419
            connect Goto30 Ec1.out as Connection1439
            connect Goto40 Eb1.out as Connection1440
            connect Goto41 Ea1.out as Connection1441
            connect "Bus Split1.out" Va_inv.in as Connection1443
            connect "Bus Split1.out1" Vb_inv.in as Connection1444
            connect "Bus Split1.out2" Vc_inv.in as Connection1445
            connect S1.ctrl_in Connect2 as Connection1442
            connect S1.c_in Ic1.n_node as Connection1449
            connect Ib1.n_node S1.b_in as Connection1450
            connect S1.a_in Ia1.n_node as Connection1451
            connect Rt0b1.p_node Cb1.p_node as Connection1456
            [
                breakpoints = 8096, 8304; 8096, 8304; 8096, 8304; 8096, 8304
            ]
            connect Rt0a1.p_node Ca1.p_node as Connection1458
            [
                breakpoints = 8016, 8288; 8016, 8304; 8016, 8304; 8016, 8288
            ]
            connect Junction290 Junction309 as Connection1457
            [
                breakpoints = 7168, 8688; 7168, 8688; 7600, 8688; 7600, 8688; 7600, 8688; 7600, 8688; 7728, 8688; 7856, 8688
            ]
            connect Cc1.p_node Rt0c1.p_node as Connection1459
            [
                breakpoints = 8176, 8304; 8176, 8304; 8176, 8304; 8176, 8304; 8176, 8288
            ]
            connect Ec1.n_node Junction317 as Connection1460
            connect Junction317 Junction315 as Connection1461
            [
                breakpoints = 8544, 8688; 8544, 8688; 8464, 8688
            ]
            connect Va Junction318 as Connection1463
            connect Junction318 S1.a_out as Connection1464
            connect Va1.p_node Junction318 as Connection1465
            connect Junction319 Junction317 as Connection1467
            connect Va1.n_node Junction319 as Connection1468
            connect S1.b_out Junction320 as Connection1469
            connect Junction320 Vb as Connection1470
            connect Vb1.p_node Junction320 as Connection1471
            connect Junction321 Junction319 as Connection1473
            connect Vb1.n_node Junction321 as Connection1474
            connect Vc Junction322 as Connection1475
            connect Junction322 S1.c_out as Connection1476
            connect Vc1.p_node Junction322 as Connection1477
            connect ground Junction323 as Connection1478
            connect Junction323 Junction321 as Connection1479
            connect Vc1.n_node Junction323 as Connection1480

            Ts = "Ts_inv"

            mask {
                description = "<html><head><meta name=\"qrichtext\" content=\"1\"></meta><style type=\"text/css\">p, li { white-space: pre-wrap; }</style></head><body style=\"\"><p style=\"margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">A grid-feeding three-phase inverter</p></body></html>"

                S {
                    label = "Rated Power (system)"
                    widget = edit
                    type = generic
                    default_value = "15.5e6"
                    unit = "VA"
                    group = "1. Three-phase Inverter"
                }

                S_i {
                    label = "Rated Power (inverter)"
                    widget = edit
                    type = generic
                    default_value = "5e6"
                    unit = "VA"
                    group = "1. Three-phase Inverter"
                }

                V_ABC {
                    label = "Rated Phase Voltage (RMS)"
                    widget = edit
                    type = generic
                    default_value = "480/np.sqrt(3)"
                    unit = "V"
                    group = "1. Three-phase Inverter"
                }

                w_0 {
                    label = "Nominal Frequency"
                    widget = edit
                    type = generic
                    default_value = "2*np.pi*60"
                    unit = "rad/s"
                    group = "1. Three-phase Inverter"
                }

                Ts {
                    label = "Execution rate (inverter)"
                    widget = edit
                    type = generic
                    default_value = "Ts_gfeed"
                    unit = "s"
                    group = "1. Three-phase Inverter"
                }

                Ts_sys {
                    label = "Execution rate (system)"
                    widget = edit
                    type = generic
                    default_value = "Ts"
                    unit = "s"
                    group = "1. Three-phase Inverter"
                }

                R_i {
                    label = "Input Resistance"
                    widget = edit
                    type = generic
                    default_value = "1e-3"
                    unit = "Ω"
                    group = "2. LCL filter"
                }

                L_i {
                    label = "Input Inductance"
                    widget = edit
                    type = generic
                    default_value = "7e-6"
                    unit = "H"
                    group = "2. LCL filter"
                }

                R_s {
                    label = "Shunt Resistance"
                    widget = edit
                    type = generic
                    default_value = "1e-3"
                    unit = "Ω"
                    group = "2. LCL filter"
                }

                C_s {
                    label = "Shunt Capacitance"
                    widget = edit
                    type = generic
                    default_value = "800e-6"
                    unit = "F"
                    group = "2. LCL filter"
                }

                R_o {
                    label = "Output Resistance"
                    widget = edit
                    type = generic
                    default_value = "0.15e-3"
                    unit = "Ω"
                    group = "2. LCL filter"
                }

                L_o {
                    label = "Output Inductance"
                    widget = edit
                    type = generic
                    default_value = "4e-6"
                    unit = "H"
                    group = "2. LCL filter"
                }

                Kp_I {
                    label = "Inner Loop Proportional Gain"
                    widget = edit
                    type = generic
                    default_value = "7e-6/1e-3"
                    group = "4. Cascaded Controller"
                }

                Ki_I {
                    label = "Inner Loop Integral Gain"
                    widget = edit
                    type = generic
                    default_value = "1e-3/1e-3"
                    group = "4. Cascaded Controller"
                }

                Imax {
                    label = "Inner Loop Upper Limit"
                    widget = edit
                    type = generic
                    default_value = "1"
                    group = "4. Cascaded Controller"
                }

                Imin {
                    label = "Inner Loop Lower Limit"
                    widget = edit
                    type = generic
                    default_value = "-1"
                    group = "4. Cascaded Controller"
                }

                Kp_PLL {
                    label = "Proportional Gain"
                    widget = edit
                    type = generic
                    default_value = "5"
                    group = "5. Phase Locked Loop"
                }

                Ki_PLL {
                    label = "Integral Gain"
                    widget = edit
                    type = generic
                    default_value = "2"
                    group = "5. Phase Locked Loop"
                }

                PLL_max {
                    label = "Saturation Upper Limit"
                    widget = edit
                    type = generic
                    default_value = "2*np.pi*63"
                    group = "5. Phase Locked Loop"
                }

                PLL_min {
                    label = "Saturation Lower Limit"
                    widget = edit
                    type = generic
                    default_value = "2*np.pi*57"
                    group = "5. Phase Locked Loop"
                }

                CODE open
                    from typhoon.apps.schematic_editor.dialogs.component_property_dialogs.general import RegularComponentPropertiesDialog
                
                    dialog = RegularComponentPropertiesDialog(
                        component=component,
                        property_container=component.masks[-1],
                        current_diagram=current_diagram
                    )
                    dialog.exec_()
                    
                ENDCODE

                CODE init
                    S = mdl.get_property_value(mdl.prop(item_handle, "S"))
                    S_i = mdl.get_property_value(mdl.prop(item_handle, "S_i"))
                    V_ABC = mdl.get_property_value(mdl.prop(item_handle, "V_ABC"))
                    w_0 = mdl.get_property_value(mdl.prop(item_handle, "w_0"))
                    Ts = mdl.get_property_value(mdl.prop(item_handle, "Ts"))
                    R_i = mdl.get_property_value(mdl.prop(item_handle, "R_i"))
                    L_i = mdl.get_property_value(mdl.prop(item_handle, "L_i"))
                    R_s = mdl.get_property_value(mdl.prop(item_handle, "R_s"))
                    C_s = mdl.get_property_value(mdl.prop(item_handle, "C_s"))
                    R_o = mdl.get_property_value(mdl.prop(item_handle, "R_o"))
                    L_o = mdl.get_property_value(mdl.prop(item_handle, "L_o"))
                    Kp_I = mdl.get_property_value(mdl.prop(item_handle, "Kp_I"))
                    Ki_I = mdl.get_property_value(mdl.prop(item_handle, "Ki_I"))
                    Imax = mdl.get_property_value(mdl.prop(item_handle, "Imax"))
                    Imin = mdl.get_property_value(mdl.prop(item_handle, "Imin"))
                    Kp_PLL = mdl.get_property_value(mdl.prop(item_handle, "Kp_PLL"))
                    Ki_PLL = mdl.get_property_value(mdl.prop(item_handle, "Ki_PLL"))
                    PLL_max = mdl.get_property_value(mdl.prop(item_handle, "PLL_max"))
                    PLL_min = mdl.get_property_value(mdl.prop(item_handle, "PLL_min"))
                    
                    Tfast = Ts
                    V_DQ = V_ABC*np.sqrt(2)
                    I_DQ = 2*S/(3*V_DQ)
                    Z_DQ = V_DQ/I_DQ
                    C_DQ = 1/(Z_DQ*w_0)
                    L_DQ = Z_DQ/w_0
                    
                    Kp_I = Kp_I/Z_DQ
                    Ki_I = Ki_I*C_DQ
                    
                    Rs = R_s/Z_DQ
                    Li = L_i/L_DQ
                ENDCODE

                CODE define_icon
                    mdl.set_component_icon_image(item_handle, 'grid_feeding_inverter.svg')
                ENDCODE

                CODE pre_compile
                ENDCODE
            }
        }
        [
            position = 8224, 8336
            size = 168, 112
        ]

        component "core/RL Section" RL1 {
            inductance_per_l_mile = "1.6e-3"
            length_mile = "0.1"
            resistance_per_l_mile = "0.57"
        }
        [
            position = 8504, 8160
            size = 256, 56
        ]

        tag V_d_a {
            value = "VbG"
            scope = masked_subsystem
            kind = sp
            direction = out
        }
        [
            position = 9328, 8296
            hide_name = True
            scale = -1, 1
        ]

        tag V_q_a {
            value = "VaG"
            scope = masked_subsystem
            kind = sp
            direction = out
        }
        [
            position = 9432, 8248
            hide_name = True
            scale = -1, 1
        ]

        tag V_d_a2 {
            value = "VcG"
            scope = masked_subsystem
            kind = sp
            direction = out
        }
        [
            position = 9224, 8344
            hide_name = True
            scale = -1, 1
        ]

        tag V_d_a1 {
            value = "VbG"
            scope = masked_subsystem
            kind = sp
            direction = in
        }
        [
            position = 9584, 8376
            hide_name = True
        ]

        tag V_q_a1 {
            value = "VaG"
            scope = masked_subsystem
            kind = sp
            direction = in
        }
        [
            position = 9584, 8328
            hide_name = True
        ]

        tag V_q_a2 {
            value = "VcG"
            scope = masked_subsystem
            kind = sp
            direction = in
        }
        [
            position = 9584, 8424
            hide_name = True
        ]

        junction Junction61 pe
        [
            position = 9368, 8480
        ]

        junction Junction63 pe
        [
            position = 9160, 8480
        ]

        junction Junction64 pe
        [
            position = 9264, 8480
        ]

        junction Junction66 pe
        [
            position = 9160, 8272
        ]

        junction Junction67 pe
        [
            position = 9160, 8424
        ]

        junction Junction68 pe
        [
            position = 9368, 8184
        ]

        junction Junction69 pe
        [
            position = 9368, 8304
        ]

        junction Junction70 pe
        [
            position = 9264, 8456
        ]

        junction Junction71 pe
        [
            position = 9264, 8224
        ]

        junction Junction76 pe
        [
            position = 8720, 8160
        ]

        junction Junction77 pe
        [
            position = 8752, 8176
        ]

        junction Junction78 pe
        [
            position = 8720, 8480
        ]

        junction Junction79 pe
        [
            position = 8272, 8144
        ]

        junction Junction80 pe
        [
            position = 8688, 8144
        ]

        connect V_q_a Va_G.in as Connection312
        connect V_d_a Vb_G.in as Connection313
        connect V_d_a2 Vc_G.in as Connection314
        connect V_q_a1 Gain3.out as Connection315
        connect "Sinusoidal Source1.out" Gain3.in as Connection328
        connect Gain4.in "Sinusoidal Source3.out" as Connection789
        connect "Sinusoidal Source2.out" Gain5.in as Connection790
        connect Gain5.out V_d_a1 as Connection791
        connect Gain4.out V_q_a2 as Connection792
        connect gnd1.node Junction61 as Connection820
        connect Junction61 Junction64 as Connection827
        [
            breakpoints = 9296, 8480
        ]
        connect Junction64 Junction63 as Connection828
        connect RL2.P5 Junction66 as Connection872
        [
            breakpoints = 9096, 8184; 9096, 8216; 9160, 8216
        ]
        connect Junction66 Vc_G.p_node as Connection873
        connect Vc.p_node Junction66 as Connection874
        connect Vc_G.n_node Junction67 as Connection875
        connect Junction67 Junction63 as Connection876
        connect Vc.n_node Junction67 as Connection877
        connect RL2.P1 Junction68 as Connection878
        [
            breakpoints = 9096, 8144; 9096, 8104; 9368, 8104
        ]
        connect Junction68 Va_G.p_node as Connection879
        connect Va.p_node Junction68 as Connection880
        connect Va_G.n_node Junction69 as Connection881
        connect Junction69 Junction61 as Connection882
        connect Va.n_node Junction69 as Connection883
        connect Vb_G.n_node Junction70 as Connection884
        connect Junction70 Junction64 as Connection885
        connect Vb.n_node Junction70 as Connection886
        connect RL2.P3 Junction71 as Connection887
        connect Junction71 Vb_G.p_node as Connection888
        connect Vb.p_node Junction71 as Connection889
        connect Pref.out "Grid feeding inverter (averaged).setpoint_P" as Connection941
        connect Qref.out "Grid feeding inverter (averaged).setpoint_Q" as Connection942
        connect RL2.P4 Junction76 as Connection946
        connect Junction76 "Constant Impedance Load1.B" as Connection947
        [
            breakpoints = 8720, 8160; 8720, 8160; 8720, 8160; 8720, 8160
        ]
        connect RL2.P6 Junction77 as Connection949
        connect Junction77 "Constant Impedance Load1.C" as Connection950
        [
            breakpoints = 8752, 8176; 8752, 8176; 8752, 8176; 8752, 8176
        ]
        connect Junction63 Junction78 as Connection952
        [
            breakpoints = 9160, 8480; 9160, 8480; 9160, 8480; 9160, 8480; 9160, 8480
        ]
        connect Junction78 "Constant Impedance Load1.N" as Connection953
        [
            breakpoints = 8720, 8480; 8720, 8480; 8720, 8480; 8720, 8480; 8720, 8480; 8720, 8480; 8720, 8480
        ]
        connect "Grid feeding inverter (averaged).ground" Junction78 as Connection954
        connect "Grid feeding inverter (averaged).Vc" RL1.P6 as Connection955
        connect RL1.P5 Junction77 as Connection956
        connect "Grid feeding inverter (averaged).Vb" RL1.P4 as Connection957
        connect RL1.P3 Junction76 as Connection958
        connect "Grid feeding inverter (averaged).Va" Junction79 as Connection961
        connect Junction79 "Device Marker1.node" as Connection962
        [
            breakpoints = 8272, 8144; 8272, 8144; 8272, 8144; 8272, 8144
        ]
        connect RL1.P2 Junction79 as Connection963
        connect "Constant Impedance Load1.A" Junction80 as Connection964
        connect Junction80 RL2.P2 as Connection965
        [
            breakpoints = 8688, 8144; 8688, 8144
        ]
        connect RL1.P1 Junction80 as Connection966
    }

    default {
        gen_bus_join {
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_bus_split {
            outputs = "2"
            execution_rate = "inherit"
        }

        gen_c_function {
            in_terminal_properties = "real in;"
            in_terminal_labels = ""
            out_terminal_properties = "real out;"
            out_terminal_labels = ""
            no_feed_inputs = ""
            no_feed_outputs = ""
            in_terminal_dimensions = ""
            in_terminal_dimensions_str = ""
            out_terminal_dimensions = ""
            out_terminal_dimensions_str = ""
            output_fnc = ""
            update_fnc = ""
            init_fnc = ""
            global_variables = ""
            parameters = ""
            execution_rate = "inherit"
        }

        gen_comparator {
            execution_rate = "inherit"
        }

        gen_digital_probe {
            override_signal_name = "False"
            signal_name = ""
            streaming_en = "False"
            addr = "0"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        gen_gain {
            gain = "1"
            multiplication = "Element-wise(K.*u)"
            execution_rate = "inherit"
        }

        gen_logic_op {
            operator = "AND"
            inputs = "2"
            execution_rate = "inherit"
        }

        gen_math_fnc {
            mathematical_fn = "exponential"
            execution_rate = "inherit"
        }

        gen_pid_controller {
            controller_type = "PID"
            kp = "1"
            kp_source = "internal"
            ki = "1"
            ki_source = "internal"
            kd = "0"
            kd_source = "internal"
            filt_coef = "100"
            int_init_value = "0"
            filt_init_value = "0"
            enb_output_limit_out = "False"
            upper_sat_lim = "1"
            lower_sat_lim = "-1"
            enb_anti_windup_out = "False"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        gen_probe {
            addr = "0"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "generic"
            streaming_en = "False"
            streaming_er_idx = "0"
            execution_rate = "inherit"
        }

        gen_product {
            signs = "2"
            execution_rate = "inherit"
        }

        gen_sum {
            signs = "2"
            execution_rate = "inherit"
        }

        gen_terminator {
            execution_rate = "inherit"
        }

        gen_trigonometric {
            trigonometric_fn = "sin"
            angle = "Radians"
            execution_rate = "inherit"
        }

        pas_capacitor {
            capacitance = "1e-6"
            initial_voltage = "0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        pas_inductor {
            inductance = "1e-3"
            initial_current = "0.0"
            pole_shift_ignore = "False"
            visible = "True"
        }

        pas_resistor {
            resistance = "1"
        }

        src_constant {
            value = "1"
            signal_type = "real"
            execution_rate = "100e-6"
        }

        src_scada_input {
            addr = "0"
            format = "real"
            override_signal_name = "False"
            signal_name = ""
            signal_type = "real"
            min = "-1e6"
            max = "1e6"
            def_value = "0"
            unit = " "
            execution_rate = "100e-6"
        }

        src_sine {
            amplitude = "1"
            dc_offset = "0"
            frequency = "50"
            phase = "0"
            execution_rate = "100e-6"
        }

        sys_hil_marker {
            hil_device_id = "0"
            override_hw_settings = "False"
            hw_configuration_id = "1"
            override_sim_settings = "False"
            simulation_method = "exact"
            simulation_time_step = "auto"
            ss_calc_method = "systematic elimination"
            enb_pole_shift = "True"
            enb_gds_oversampling = "True"
            show_modes = "False"
            cpl_stb = "False"
            cpl_dynamics_analysis = "False"
            matrix_based_reduction = "True"
            enb_dep_sw_detect = "False"
            override_user_sp_settings = "False"
            user_cpu_optimization = "high"
            code_section = "Internal Memory"
            data_section = "Internal Memory"
            override_sys_sp_settings = "False"
            sys_cpu_optimization = "high"
            sys_sp_rate_1 = "100e-6"
            sys_sp_rate_2 = "50e-3"
        }

        sys_signal_switch {
            criterion = "ctrl >= threshold"
            threshold = "0"
            execution_rate = "inherit"
        }

        tm_delay {
            init_value = "0"
            signal_out_type = "inherit"
            execution_rate = "inherit"
        }

        "core/Constant Impedance Load" {
            fn = "60"
            conn_type = "Y"
            enable_neutral = "False"
            set_balanced = "True"
            Vn_3ph = "480"
            Sn_3ph = "1.0e6"
            pf_mode_3ph = "Unit"
            pf_3ph = "0.9"
            VAn = "480/(3**0.5)"
            VAB = "480"
            SAn = "1.0e6/3"
            SAB = "1.0e6/3"
            pf_modeA = "Unit"
            pfA = "0.9"
            VBn = "480/(3**0.5)"
            VBC = "480"
            SBn = "1.0e6/3"
            SBC = "1.0e6/3"
            pf_modeB = "Unit"
            pfB = "0.9"
            VCn = "480/(3**0.5)"
            VCA = "480"
            SCn = "1.0e6/3"
            SCA = "1.0e6/3"
            pf_modeC = "Unit"
            pfC = "0.9"
        }

        "core/Current Measurement" {
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "core/RL Section" {
            model_def = "R-L"
            unit_sys = "imperial"
            num_of_phases = "3"
            resistance_per_l = "1"
            resistance_per_l_mile = "1"
            inductance_per_l = "1e-3"
            inductance_per_l_mile = "1e-3"
            length = "1.0"
            length_mile = "1.0"
            power = "500.0"
            voltage = "11.0"
            frequency = "50.0"
            R_value = "21.55"
            L_value = "0.00842"
            embedded_coupling = "False"
            ratio_type = "Automatic"
            ratio = "0.1"
        }

        "core/Signal Controlled Voltage Source" {
            execution_rate = "inherit"
        }

        "core/Triple Pole Single Throw Contactor" {
            ctrl_src = "Digital input"
            Sa = "1"
            Sa_logic = "active high"
            enable_fb_out = "False"
            fb_out_type = "real"
            execution_rate = "inherit"
            initial_state = "off"
            on_delay = "0"
            off_delay = "0"
        }

        "core/Voltage Measurement" {
            bw_limit = "False"
            frequency = "10e3"
            comparator_enable = "False"
            operator = "greater"
            threshold = "0"
            cmp_abs_value = "False"
            feed_forward = "false"
            sig_output = "False"
            execution_rate = "100e-6"
            addr = "0"
            nd_msr_estimation = "false"
            dev_cpl_msr = "false"
            host_device = "0"
            output_to_device = "0"
            dev_cpl_index = "0"
            dev_cpl_var_nb = "0"
            visible = "True"
            override_signal_name = "False"
            signal_name = ""
        }

        "core/abc to dq" {
            power_form = "variant - Clarke\'s original"
            alignment = "-pi/2"
            disable_filter = "True"
            initial_filter_output = "0"
            wn_LPFdq = "1000"
            execution_rate = "inherit"
        }

        "core/dq to abc" {
            power_form = "variant - Clarke\'s original"
            alignment = "-pi/2"
            execution_rate = "0"
        }
    }

    CODE model_init
        # Numpy module is imported as 'np'
        # Scipy module is imported as 'sp'
        # The Schematic API is imported as 'mdl'
        # To get the model file path, use 'mdl.get_model_file_path()'
        # To print information to the console, use info()
        Ts = 1e-3
        Ts_inv = 100e-6
    ENDCODE
}
